---
interface Props {
  pageId: string;
  pageTitle: string;
  pageUrl?: string;
}

const { pageId, pageTitle, pageUrl } = Astro.props;
const CUSDIS_HOST = "https://comments.natinternet.com";
const APP_ID = "62274c3e-e32b-4dcc-a63f-cfbe2ef9959b";
const fullUrl = pageUrl || Astro.url.href;
---

<div id="cusdis_thread"
  data-host={CUSDIS_HOST}
  data-app-id={APP_ID}
  data-page-id={pageId}
  data-page-url={fullUrl}
  data-page-title={pageTitle}
  data-theme="light"
></div>

<script is:inline>
  window.CUSDIS_LOCALE = {
    powered_by: 'Comments',
    post_comment: 'Post Comment',
    loading: 'Loading...',
    email: 'Email (optional)',
    nickname: 'Name',
    reply_placeholder: 'Write a comment...',
    reply_btn: 'Reply',
    sending: 'Sending...',
  };
  // Prevent auto-init, we'll do it manually after DOM ready
  window.CUSDIS_PREVENT_INITIAL_RENDER = true;
</script>
<script is:inline src="https://comments.natinternet.com/js/cusdis.umd.js"></script>
<script is:inline>
  // Initialize after DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
      if (window.CUSDIS) window.CUSDIS.initial();
    });
  } else {
    if (window.CUSDIS) window.CUSDIS.initial();
  }
</script>
